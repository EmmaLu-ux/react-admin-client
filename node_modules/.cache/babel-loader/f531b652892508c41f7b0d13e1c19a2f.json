{"ast":null,"code":"import\"antd/es/card/style\";import _Card from\"antd/es/card\";import\"antd/es/modal/style\";import _Modal from\"antd/es/modal\";import\"antd/es/table/style\";import _Table from\"antd/es/table\";import\"antd/es/button/style\";import _Button from\"antd/es/button\";import _toConsumableArray from\"/Users/emmalu/Documents/fronted/workspace/react-admin_client-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import\"antd/es/message/style\";import _message from\"antd/es/message\";import _asyncToGenerator from\"/Users/emmalu/Documents/fronted/workspace/react-admin_client-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/emmalu/Documents/fronted/workspace/react-admin_client-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/emmalu/Documents/fronted/workspace/react-admin_client-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/emmalu/Documents/fronted/workspace/react-admin_client-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/emmalu/Documents/fronted/workspace/react-admin_client-1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";function _regeneratorRuntime(){\"use strict\";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return exports;};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value;},$Symbol=\"function\"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||\"@@iterator\",asyncIteratorSymbol=$Symbol.asyncIterator||\"@@asyncIterator\",toStringTagSymbol=$Symbol.toStringTag||\"@@toStringTag\";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key];}try{define({},\"\");}catch(err){define=function define(obj,key,value){return obj[key]=value;};}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,\"_invoke\",{value:makeInvokeMethod(innerFn,self,context)}),generator;}function tryCatch(fn,obj,arg){try{return{type:\"normal\",arg:fn.call(obj,arg)};}catch(err){return{type:\"throw\",arg:err};}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this;});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){[\"next\",\"throw\",\"return\"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg);});});}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(\"throw\"!==record.type){var result=record.arg,value=result.value;return value&&\"object\"==typeof value&&hasOwn.call(value,\"__await\")?PromiseImpl.resolve(value.__await).then(function(value){invoke(\"next\",value,resolve,reject);},function(err){invoke(\"throw\",err,resolve,reject);}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result);},function(error){return invoke(\"throw\",error,resolve,reject);});}reject(record.arg);}var previousPromise;defineProperty(this,\"_invoke\",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject);});}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();}});}function makeInvokeMethod(innerFn,self,context){var state=\"suspendedStart\";return function(method,arg){if(\"executing\"===state)throw new Error(\"Generator is already running\");if(\"completed\"===state){if(\"throw\"===method)throw arg;return doneResult();}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}if(\"next\"===context.method)context.sent=context._sent=context.arg;else if(\"throw\"===context.method){if(\"suspendedStart\"===state)throw state=\"completed\",context.arg;context.dispatchException(context.arg);}else\"return\"===context.method&&context.abrupt(\"return\",context.arg);state=\"executing\";var record=tryCatch(innerFn,self,context);if(\"normal\"===record.type){if(state=context.done?\"completed\":\"suspendedYield\",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done};}\"throw\"===record.type&&(state=\"completed\",context.method=\"throw\",context.arg=record.arg);}};}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(undefined===method){if(context.delegate=null,\"throw\"===context.method){if(delegate.iterator.return&&(context.method=\"return\",context.arg=undefined,maybeInvokeDelegate(delegate,context),\"throw\"===context.method))return ContinueSentinel;context.method=\"throw\",context.arg=new TypeError(\"The iterator does not provide a 'throw' method\");}return ContinueSentinel;}var record=tryCatch(method,delegate.iterator,context.arg);if(\"throw\"===record.type)return context.method=\"throw\",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,\"return\"!==context.method&&(context.method=\"next\",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method=\"throw\",context.arg=new TypeError(\"iterator result is not an object\"),context.delegate=null,ContinueSentinel);}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry);}function resetTryEntry(entry){var record=entry.completion||{};record.type=\"normal\",delete record.arg,entry.completion=record;}function Context(tryLocsList){this.tryEntries=[{tryLoc:\"root\"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0);}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if(\"function\"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;){if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;}return next.value=undefined,next.done=!0,next;};return next.next=next;}}return{next:doneResult};}function doneResult(){return{value:undefined,done:!0};}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,\"constructor\",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,\"constructor\",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,\"GeneratorFunction\"),exports.isGeneratorFunction=function(genFun){var ctor=\"function\"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||\"GeneratorFunction\"===(ctor.displayName||ctor.name));},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,\"GeneratorFunction\")),genFun.prototype=Object.create(Gp),genFun;},exports.awrap=function(arg){return{__await:arg};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this;}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next();});},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,\"Generator\"),define(Gp,iteratorSymbol,function(){return this;}),define(Gp,\"toString\",function(){return\"[object Generator]\";}),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object){keys.push(key);}return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next;}return next.done=!0,next;};},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method=\"next\",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this){\"t\"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined);}},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if(\"throw\"===rootRecord.type)throw rootRecord.arg;return this.rval;},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type=\"throw\",record.arg=exception,context.next=loc,caught&&(context.method=\"next\",context.arg=undefined),!!caught;}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if(\"root\"===entry.tryLoc)return handle(\"end\");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,\"catchLoc\"),hasFinally=hasOwn.call(entry,\"finallyLoc\");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);}else{if(!hasFinally)throw new Error(\"try statement without catch or finally\");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,\"finallyLoc\")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break;}}finallyEntry&&(\"break\"===type||\"continue\"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method=\"next\",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record);},complete:function complete(record,afterLoc){if(\"throw\"===record.type)throw record.arg;return\"break\"===record.type||\"continue\"===record.type?this.next=record.arg:\"return\"===record.type?(this.rval=this.arg=record.arg,this.method=\"return\",this.next=\"end\"):\"normal\"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel;},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel;}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(\"throw\"===record.type){var thrown=record.arg;resetTryEntry(entry);}return thrown;}}throw new Error(\"illegal catch attempt\");},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},\"next\"===this.method&&(this.arg=undefined),ContinueSentinel;}},exports;}import React,{Component}from\"react\";import{connect}from\"react-redux\";import{PAGE_SIZE}from\"../../utils/constants.js\";import{reqAddRole,reqRoles,reqUpdateRole}from\"../../api\";import AddForm2 from\"./add-form\";import AuthForm from\"./auth-form.jsx\";// import memoryUtils from '../../utils/memoryUtils'\n// import storageUtils from '../../utils/storageUtils.js'\nimport{formateDate}from\"../../utils/dateUtils.js\";import{logout}from\"../../redux/actions\";import'./role.less';/* 角色管理路由 */var Role=/*#__PURE__*/function(_Component){_inherits(Role,_Component);var _super=_createSuper(Role);function Role(props){var _this;_classCallCheck(this,Role);_this=_super.call(this,props);_this.state={roles:[],//所有角色的列表\nrole:{},//选中的role\nisShowAdd:false,//是否显示添加界面\nisShowAuth:false//是否显示设置权限界面\n};_this.initColums=function(){_this.columns=[{title:\"角色名称\",dataIndex:\"name\"},{title:\"创建时间\",dataIndex:\"create_time\",render:formateDate},{title:\"授权时间\",dataIndex:\"auth_time\",render:formateDate},{title:\"授权人\",dataIndex:\"auth_name\"}];};_this.getRoles=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result,roles;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqRoles();case 2:result=_context.sent;if(result.status===0){roles=result.data;_this.setState({roles:roles});}else{_message.error(\"获取角色失败！\");}case 4:case\"end\":return _context.stop();}}},_callee);}));_this.onRow=function(role){return{onClick:function onClick(e){//点击行\nconsole.log(\"row onClick()\",role);_this.setState({role:role});}};};_this.addRole=function(){//进行表单验证，只有通过了才可以发起请求\n_this.form.validateFields(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(err,values){var roleName,result,role;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(err){_context2.next=9;break;}//1. 收集输入数据\nroleName=values.roleName;//重置输入的数据\n_this.form.resetFields();//2. 请求添加\n_context2.next=5;return reqAddRole(roleName);case 5:result=_context2.sent;//3. 根据结果显示\nif(result.status===0){_message.success(\"添加角色成功\");// this.getRoles()\n//更新roles的状态\nrole=result.data;// console.log(roles)\n//更新roles状态：基于原本状态数据更新，适合用函数的方式。\n_this.setState(function(state){return{roles:[].concat(_toConsumableArray(state.roles),[role]),isShowAdd:false};});}else{_message.error(\"添加角色失败！\");}//更新列表显示\n_context2.next=10;break;case 9:_message.error(\"数据校验失败！\"+err.message);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}());};_this.updateRole=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var role,menus,result;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this.setState({isShowAuth:false});role=_this.state.role;menus=_this.auth.current.getMenus();role.menus=menus;// role.auth_name = memoryUtils.user.username\nrole.auth_name=_this.props.user.username;role.auth_time=formateDate(Date.now());_context3.next=8;return reqUpdateRole(role);case 8:result=_context3.sent;if(result.status===0){//如果当前用户更新的是自己的权限，强制退出\n// if(role._id === memoryUtils.user.role_id){\nif(role._id===_this.props.user.role_id){// memoryUtils.user={}\n// storageUtils.deleteUser()\n// this.props.history.replace('/login')\n_this.props.logout();_message.success(\"当前用户角色权限修改了，重新登录！\");}else{_message.success(\"设置角色权限成功！\");_this.setState({roles:_toConsumableArray(_this.state.roles)});}}else{_message.err(\"设置角色权限失败！\");}case 10:case\"end\":return _context3.stop();}}},_callee3);}));_this.auth=React.createRef();return _this;}_createClass(Role,[{key:\"componentWillMount\",value:function componentWillMount(){this.initColums();this.getRoles();}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,roles=_this$state.roles,role=_this$state.role,isShowAdd=_this$state.isShowAdd,isShowAuth=_this$state.isShowAuth;var title=/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(_Button,{type:\"primary\",onClick:function onClick(){return _this2.setState({isShowAdd:true});}},\"\\u521B\\u5EFA\\u89D2\\u8272\"),\"\\xA0 \\xA0\",/*#__PURE__*/React.createElement(_Button,{type:\"primary\",disabled:!role._id,onClick:function onClick(){return _this2.setState({isShowAuth:true});}},\"\\u8BBE\\u7F6E\\u89D2\\u8272\\u6743\\u9650\"));return/*#__PURE__*/React.createElement(_Card,{title:title,style:{border:\"none\",borderRadius:15}},/*#__PURE__*/React.createElement(_Table,{// rowSelection={{ type: \"radio\", selectedRowKeys: [role._id] }}\nrowSelection:{type:\"radio\",selectedRowKeys:[role._id],onSelect:function onSelect(role){_this2.setState({role:role});}},onRow:this.onRow,rowKey:\"_id\"// size=\"small\"\n,dataSource:roles,columns:this.columns,pagination:{defaultPageSize:PAGE_SIZE}}),/*#__PURE__*/React.createElement(_Modal,{title:\"\\u6DFB\\u52A0\\u89D2\\u8272\",okText:\"\\u786E\\u8BA4\",cancelText:\"\\u53D6\\u6D88\",visible:isShowAdd,onOk:this.addRole,onCancel:function onCancel(){_this2.setState({isShowAdd:false});}},/*#__PURE__*/React.createElement(AddForm2,{setForm:function setForm(form){return _this2.form=form;}})),/*#__PURE__*/React.createElement(_Modal,{title:\"\\u8BBE\\u7F6E\\u89D2\\u8272\\u6743\\u9650\",okText:\"\\u786E\\u8BA4\",cancelText:\"\\u53D6\\u6D88\",visible:isShowAuth,onOk:this.updateRole,onCancel:function onCancel(){_this2.setState({isShowAuth:false});}},/*#__PURE__*/React.createElement(AuthForm,{ref:this.auth,role:role})));}}]);return Role;}(Component);export default connect(function(state){return{user:state.user};},{logout:logout})(Role);","map":{"version":3,"names":["React","Component","connect","PAGE_SIZE","reqAddRole","reqRoles","reqUpdateRole","AddForm2","AuthForm","formateDate","logout","Role","props","state","roles","role","isShowAdd","isShowAuth","initColums","columns","title","dataIndex","render","getRoles","result","status","data","setState","error","onRow","onClick","e","console","log","addRole","form","validateFields","err","values","roleName","resetFields","success","message","updateRole","menus","auth","current","getMenus","auth_name","user","username","auth_time","Date","now","_id","role_id","createRef","border","borderRadius","type","selectedRowKeys","onSelect","defaultPageSize"],"sources":["/Users/emmalu/Documents/fronted/workspace/react-admin_client-1/src/pages/role/role.jsx"],"sourcesContent":["import React, { Component } from \"react\"\nimport { Card, Table, Button, message, Modal } from \"antd\"\nimport { connect } from \"react-redux\"\n\nimport { PAGE_SIZE } from \"../../utils/constants.js\"\nimport { reqAddRole, reqRoles, reqUpdateRole } from \"../../api\"\nimport AddForm2 from \"./add-form\"\nimport AuthForm from \"./auth-form.jsx\"\n// import memoryUtils from '../../utils/memoryUtils'\n// import storageUtils from '../../utils/storageUtils.js'\nimport { formateDate } from \"../../utils/dateUtils.js\"\nimport { logout } from \"../../redux/actions\"\nimport './role.less'\n\n/* 角色管理路由 */\nclass Role extends Component {\n  state = {\n    roles: [], //所有角色的列表\n    role: {}, //选中的role\n    isShowAdd: false, //是否显示添加界面\n    isShowAuth: false, //是否显示设置权限界面\n  }\n  constructor(props) {\n    super(props)\n    this.auth = React.createRef()\n  }\n  initColums = () => {\n    this.columns = [\n      {\n        title: \"角色名称\",\n        dataIndex: \"name\",\n      },\n      {\n        title: \"创建时间\",\n        dataIndex: \"create_time\",\n        render: formateDate,\n      },\n      {\n        title: \"授权时间\",\n        dataIndex: \"auth_time\",\n        render: formateDate,\n      },\n      {\n        title: \"授权人\",\n        dataIndex: \"auth_name\",\n      },\n    ]\n  }\n  getRoles = async () => {\n    const result = await reqRoles()\n    if (result.status === 0) {\n      const roles = result.data\n      this.setState({ roles })\n    } else {\n      message.error(\"获取角色失败！\")\n    }\n  }\n  onRow = (role) => {\n    return {\n      onClick: e => {\n        //点击行\n        console.log(\"row onClick()\", role)\n        this.setState({ role })\n      },\n    }\n  }\n  /* 添加角色 */\n  addRole = () => {\n    //进行表单验证，只有通过了才可以发起请求\n    this.form.validateFields(async (err, values) => {\n      if (!err) {\n        //1. 收集输入数据\n        const { roleName } = values\n        //重置输入的数据\n        this.form.resetFields()\n        //2. 请求添加\n        const result = await reqAddRole(roleName)\n        //3. 根据结果显示\n        if (result.status === 0) {\n          message.success(\"添加角色成功\")\n          // this.getRoles()\n          //更新roles的状态\n          const role = result.data\n          // console.log(roles)\n          //更新roles状态：基于原本状态数据更新，适合用函数的方式。\n          this.setState((state) => ({\n            roles: [...state.roles, role],\n            isShowAdd: false,\n          }))\n        } else {\n          message.error(\"添加角色失败！\")\n        }\n        //更新列表显示\n      } else {\n        message.error(\"数据校验失败！\" + err.message)\n      }\n    })\n  }\n  /* 更新角色 */\n  updateRole = async () => {\n    this.setState({\n      isShowAuth: false,\n    })\n    const role = this.state.role\n    const menus = this.auth.current.getMenus()\n    role.menus = menus\n    // role.auth_name = memoryUtils.user.username\n    role.auth_name = this.props.user.username\n    role.auth_time = formateDate(Date.now())\n    const result = await reqUpdateRole(role)\n    if (result.status === 0) {\n      //如果当前用户更新的是自己的权限，强制退出\n      // if(role._id === memoryUtils.user.role_id){\n      if (role._id === this.props.user.role_id) {\n        // memoryUtils.user={}\n        // storageUtils.deleteUser()\n        // this.props.history.replace('/login')\n        this.props.logout()\n        message.success(\"当前用户角色权限修改了，重新登录！\")\n      } else {\n        message.success(\"设置角色权限成功！\")\n        this.setState({\n          roles: [...this.state.roles],\n        })\n      }\n    } else {\n      message.err(\"设置角色权限失败！\")\n    }\n  }\n  componentWillMount() {\n    this.initColums()\n    this.getRoles()\n  }\n  render() {\n    const { roles, role, isShowAdd, isShowAuth } = this.state\n    const title = (\n      <span>\n        <Button\n          type=\"primary\"\n          onClick={() => this.setState({ isShowAdd: true })}\n        >\n          创建角色\n        </Button>\n        &nbsp; &nbsp;\n        <Button\n          type=\"primary\"\n          disabled={!role._id}\n          onClick={() => this.setState({ isShowAuth: true })}\n        >\n          设置角色权限\n        </Button>\n      </span>\n    )\n    return (\n      <Card title={title} style={{border: \"none\", borderRadius: 15}}>\n        <Table\n          // rowSelection={{ type: \"radio\", selectedRowKeys: [role._id] }}\n          rowSelection={{\n            type: \"radio\",\n            selectedRowKeys: [role._id],\n            onSelect: (role) => {\n              this.setState({ role })\n            },\n          }}\n          onRow={this.onRow}\n          rowKey=\"_id\"\n          // size=\"small\"\n          dataSource={roles}\n          columns={this.columns}\n          pagination={{ defaultPageSize: PAGE_SIZE }}\n        />\n        <Modal\n          title=\"添加角色\"\n          okText=\"确认\"\n          cancelText=\"取消\"\n          visible={isShowAdd}\n          onOk={this.addRole}\n          onCancel={() => {\n            this.setState({ isShowAdd: false })\n          }}\n        >\n          <AddForm2 setForm={(form) => (this.form = form)} />\n        </Modal>\n        <Modal\n          title=\"设置角色权限\"\n          okText=\"确认\"\n          cancelText=\"取消\"\n          visible={isShowAuth}\n          onOk={this.updateRole}\n          onCancel={() => {\n            this.setState({ isShowAuth: false })\n          }}\n        >\n          <AuthForm ref={this.auth} role={role} />\n        </Modal>\n      </Card>\n    )\n  }\n}\n\nexport default connect((state) => ({ user: state.user }), { logout })(Role)\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}